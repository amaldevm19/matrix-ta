DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002567-04'; 
DECLARE @FromDate DATE = '2023-12-11 00:00:00.000';
DECLARE @ToDate DATE = '2024-05-05 00:00:00.000'; 

DECLARE @DoInsert BIT = 1;


IF EXISTS (
    SELECT 1
    FROM [COSEC].[dbo].[Mx_JPCJobMst]
    WHERE [COSEC].[dbo].[Mx_JPCJobMst].JobCode=@JobCode AND [COSEC].[dbo].[Mx_JPCJobMst].ToDate >= @ToDate AND [COSEC].[dbo].[Mx_JPCJobMst].FromDate <= @FromDate
) AND EXISTS (
    SELECT 1
    FROM [COSEC].[dbo].[Mx_UserMst]
    WHERE [COSEC].[dbo].[Mx_UserMst].UserID = @UserID
)
BEGIN
    DECLARE cursorFoundRows CURSOR FOR
    SELECT FromDate, ToDate, JobCode
    FROM [COSEC].[dbo].[Mx_JPCUserJobTrn]
    WHERE UserID = @UserID;

    OPEN cursorFoundRows;

    DECLARE @foundRowFromDate DATE, @foundRowToDate DATE, @foundRowJobCode NVARCHAR(30);

    FETCH NEXT FROM cursorFoundRows INTO @foundRowFromDate, @foundRowToDate, @foundRowJobCode;

    WHILE @@FETCH_STATUS = 0
    BEGIN
        --LOGIC A
         IF @FromDate = @foundRowFromDate AND @ToDate = @foundRowToDate
            BEGIN
                DELETE FROM [COSEC].[dbo].[Mx_JPCUserJobTrn]
                WHERE UserID = @UserID AND JobCode = @foundRowJobCode AND FromDate = @foundRowFromDate AND ToDate = @foundRowToDate;
            END
        --LOGIC B
        ELSE IF @FromDate = @foundRowFromDate AND  @ToDate < @foundRowToDate
				IF @JobCode = @foundRowJobCode
					BEGIN
						SET @DoInsert = 0;
						BREAK;
					END
				ELSE
					BEGIN
						UPDATE [COSEC].[dbo].[Mx_JPCUserJobTrn]
						SET FromDate = DATEADD(DAY, 1, @ToDate)
						WHERE UserID = @UserID AND JobCode = @foundRowJobCode AND FromDate = @foundRowFromDate AND  ToDate = @foundRowToDate;
					END
         --LOGIC B-1
        ELSE IF @FromDate = @foundRowFromDate AND  @ToDate > @foundRowToDate
				BEGIN
					DELETE FROM [COSEC].[dbo].[Mx_JPCUserJobTrn]
					WHERE UserID = @UserID AND JobCode = @foundRowJobCode AND FromDate = @foundRowFromDate AND  ToDate = @foundRowToDate;
				END

         --LOGIC C
        ELSE IF @FromDate > @foundRowFromDate AND  @ToDate = @foundRowToDate
				IF @JobCode = @foundRowJobCode
					BEGIN
						SET @DoInsert = 0;
						BREAK;
					END
				ELSE
					BEGIN
						UPDATE [COSEC].[dbo].[Mx_JPCUserJobTrn]
						SET ToDate = DATEADD(DAY, -1, @FromDate)
						WHERE UserID = @UserID AND JobCode = @foundRowJobCode AND FromDate =  @foundRowFromDate AND  ToDate = @foundRowToDate;
					END

        --LOGIC C-1
        ELSE IF @FromDate < @foundRowFromDate AND  @ToDate = @foundRowToDate
				BEGIN
					DELETE FROM [COSEC].[dbo].[Mx_JPCUserJobTrn]
					WHERE UserID = @UserID AND JobCode = @foundRowJobCode AND FromDate =  @foundRowFromDate AND  ToDate = @foundRowToDate;
				END

        --LOGIC D
        ELSE IF @FromDate > @foundRowFromDate AND @FromDate <= @foundRowToDate  AND @ToDate > @foundRowToDate
				BEGIN
					UPDATE [COSEC].[dbo].[Mx_JPCUserJobTrn]
					SET ToDate = DATEADD(DAY, -1, @FromDate)
					WHERE UserID = @UserID AND  JobCode = @foundRowJobCode AND FromDate =  @foundRowFromDate AND ToDate = @foundRowToDate;
				END
         --LOGIC E
        ELSE IF @FromDate < @foundRowFromDate AND @ToDate >= @foundRowFromDate AND @ToDate < @foundRowToDate
				BEGIN
					UPDATE [COSEC].[dbo].[Mx_JPCUserJobTrn]
					SET FromDate = DATEADD(DAY, 1, @ToDate)
					WHERE UserID = @UserID AND JobCode = @foundRowJobCode AND FromDate = @foundRowFromDate AND ToDate = @foundRowToDate;
				END

		 --LOGIC F
        ELSE IF @FromDate < @foundRowFromDate AND @ToDate > @foundRowToDate
				BEGIN
					DELETE FROM [COSEC].[dbo].[Mx_JPCUserJobTrn]
					WHERE UserID = @UserID AND JobCode = @foundRowJobCode AND FromDate = @foundRowFromDate AND ToDate = @foundRowToDate;
				END
        --LOGIC G
        ELSE IF @FromDate > @foundRowFromDate AND  @ToDate < @foundRowToDate
				IF @JobCode = @foundRowJobCode
					BEGIN
						SET @DoInsert = 0;
						BREAK;
					END
				ELSE
					BEGIN
						UPDATE [COSEC].[dbo].[Mx_JPCUserJobTrn]
						SET ToDate = DATEADD(DAY, -1, @FromDate)
						WHERE UserID = @UserID AND JobCode = @foundRowJobCode AND FromDate = @foundRowFromDate AND ToDate = @foundRowToDate ;

						INSERT INTO [COSEC].[dbo].[Mx_JPCUserJobTrn] (FromDate, ToDate, UserID, JobCode,ESSAssignment)
						VALUES (DATEADD(DAY, 1, @ToDate), @foundRowToDate, @UserID, @foundRowJobCode,1);
					END
        FETCH NEXT FROM cursorFoundRows INTO @foundRowFromDate, @foundRowToDate, @foundRowJobCode;
    END
    CLOSE cursorFoundRows;
    DEALLOCATE cursorFoundRows;
    IF @DoInsert = 1
    BEGIN
        INSERT INTO [COSEC].[dbo].[Mx_JPCUserJobTrn] (FromDate, ToDate, UserID, JobCode,ESSAssignment)
        VALUES (@FromDate, @ToDate, @UserID, @JobCode, 1);
    END
END


-- LOGIC A with Same Job
DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002567-04'; 
DECLARE @FromDate DATE = '2022-11-11 00:00:00.000';
DECLARE @ToDate DATE = '2025-02-05 00:00:00.000';

-- LOGIC A with Same Job
DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002567-04'; 
DECLARE @FromDate DATE = '2022-11-11 00:00:00.000';
DECLARE @ToDate DATE = '2025-02-05 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002567-04'; 
DECLARE @FromDate DATE = '2022-11-11 00:00:00.000';
DECLARE @ToDate DATE = '2025-02-05 00:00:00.000';

-- LOGIC A with Different Job
DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002567-04'; 
DECLARE @FromDate DATE = '2022-11-11 00:00:00.000';
DECLARE @ToDate DATE = '2025-02-05 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2022-11-11 00:00:00.000';
DECLARE @ToDate DATE = '2025-02-05 00:00:00.000';

-- LOGIC A with Different Job Output
DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2022-11-11 00:00:00.000';
DECLARE @ToDate DATE = '2025-02-05 00:00:00.000';

--LOGIC B with same job 
DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2022-11-11 00:00:00.000';
DECLARE @ToDate DATE = '2025-02-05 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2022-11-11 00:00:00.000';
DECLARE @ToDate DATE = '2023-02-05 00:00:00.000';

--LOGIC B with same job -OUT PUT
DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2022-11-11 00:00:00.000';
DECLARE @ToDate DATE = '2025-02-05 00:00:00.000';


--LOGIC B with different job 
DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2022-11-11 00:00:00.000';
DECLARE @ToDate DATE = '2025-02-05 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002567-04'; 
DECLARE @FromDate DATE = '2022-11-11 00:00:00.000';
DECLARE @ToDate DATE = '2023-02-05 00:00:00.000';

--LOGIC B with different job - Output
DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002567-04'; 
DECLARE @FromDate DATE = '2022-11-11 00:00:00.000';
DECLARE @ToDate DATE = '2023-02-05 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2023-02-06 00:00:00.000';
DECLARE @ToDate DATE = '2025-02-05 00:00:00.000';


--LOGIC C with Same job
DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002567-04'; 
DECLARE @FromDate DATE = '2022-11-11 00:00:00.000';
DECLARE @ToDate DATE = '2023-02-05 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2023-02-06 00:00:00.000';
DECLARE @ToDate DATE = '2025-02-05 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002567-04'; 
DECLARE @FromDate DATE = '2022-12-11 00:00:00.000';
DECLARE @ToDate DATE = '2023-02-05 00:00:00.000';

--LOGIC C with Same job - Output
DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002567-04'; 
DECLARE @FromDate DATE = '2022-11-11 00:00:00.000';
DECLARE @ToDate DATE = '2023-02-05 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2023-02-06 00:00:00.000';
DECLARE @ToDate DATE = '2025-02-05 00:00:00.000';


--LOGIC C with different job
DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002567-04'; 
DECLARE @FromDate DATE = '2022-11-11 00:00:00.000';
DECLARE @ToDate DATE = '2023-02-05 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2023-02-06 00:00:00.000';
DECLARE @ToDate DATE = '2025-02-05 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002200-04'; 
DECLARE @FromDate DATE = '2022-12-11 00:00:00.000';
DECLARE @ToDate DATE = '2023-02-05 00:00:00.000';


--LOGIC C with different job - Output

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002567-04'; 
DECLARE @FromDate DATE = '2022-11-11 00:00:00.000';
DECLARE @ToDate DATE = '2022-12-10 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002200-04'; 
DECLARE @FromDate DATE = '2022-12-11 00:00:00.000';
DECLARE @ToDate DATE = '2023-02-05 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2023-02-06 00:00:00.000';
DECLARE @ToDate DATE = '2025-02-05 00:00:00.000';


--LOGIC D and E with different job

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002567-04'; 
DECLARE @FromDate DATE = '2022-11-11 00:00:00.000';
DECLARE @ToDate DATE = '2022-12-10 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002200-04'; 
DECLARE @FromDate DATE = '2022-12-11 00:00:00.000';
DECLARE @ToDate DATE = '2023-02-05 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2023-02-06 00:00:00.000';
DECLARE @ToDate DATE = '2025-02-05 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002567-04'; 
DECLARE @FromDate DATE = '2023-01-11 00:00:00.000';
DECLARE @ToDate DATE = '2023-12-10 00:00:00.000';

--LOGIC D and E with different job - Output

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002567-04'; 
DECLARE @FromDate DATE = '2022-11-11 00:00:00.000';
DECLARE @ToDate DATE = '2022-12-10 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002200-04'; 
DECLARE @FromDate DATE = '2022-12-11 00:00:00.000';
DECLARE @ToDate DATE = '2023-01-10 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002567-04'; 
DECLARE @FromDate DATE = '2023-01-11 00:00:00.000';
DECLARE @ToDate DATE = '2023-12-10 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2023-12-11 00:00:00.000';
DECLARE @ToDate DATE = '2025-02-05 00:00:00.000';

--LOGIC F with different job

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002567-04'; 
DECLARE @FromDate DATE = '2022-11-11 00:00:00.000';
DECLARE @ToDate DATE = '2022-12-10 00:00:00.000';
--
DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002200-04'; 
DECLARE @FromDate DATE = '2022-12-11 00:00:00.000';
DECLARE @ToDate DATE = '2023-01-10 00:00:00.000';
--
DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002567-04'; 
DECLARE @FromDate DATE = '2023-01-11 00:00:00.000';
DECLARE @ToDate DATE = '2023-12-10 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2023-12-11 00:00:00.000';
DECLARE @ToDate DATE = '2025-02-05 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2022-11-30 00:00:00.000';
DECLARE @ToDate DATE = '2023-04-05 00:00:00.000';


--LOGIC F with different job Output

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002567-04'; 
DECLARE @FromDate DATE = '2022-11-11 00:00:00.000';
DECLARE @ToDate DATE = '2022-11-29 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2022-11-30 00:00:00.000';
DECLARE @ToDate DATE = '2023-04-05 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002567-04'; 
DECLARE @FromDate DATE = '2023-04-06 00:00:00.000';
DECLARE @ToDate DATE = '2023-12-10 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2023-12-11 00:00:00.000';
DECLARE @ToDate DATE = '2025-02-05 00:00:00.000';


--LOGIC G with same job

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002567-04'; 
DECLARE @FromDate DATE = '2022-11-11 00:00:00.000';
DECLARE @ToDate DATE = '2022-11-29 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2022-11-30 00:00:00.000';
DECLARE @ToDate DATE = '2023-04-05 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002567-04'; 
DECLARE @FromDate DATE = '2023-04-06 00:00:00.000';
DECLARE @ToDate DATE = '2023-12-10 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2023-12-11 00:00:00.000';
DECLARE @ToDate DATE = '2025-02-05 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2024-01-11 00:00:00.000';
DECLARE @ToDate DATE = '2024-10-05 00:00:00.000';

--LOGIC G with same job Output

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002567-04'; 
DECLARE @FromDate DATE = '2022-11-11 00:00:00.000';
DECLARE @ToDate DATE = '2022-11-29 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2022-11-30 00:00:00.000';
DECLARE @ToDate DATE = '2023-04-05 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002567-04'; 
DECLARE @FromDate DATE = '2023-04-06 00:00:00.000';
DECLARE @ToDate DATE = '2023-12-10 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2023-12-11 00:00:00.000';
DECLARE @ToDate DATE = '2025-02-05 00:00:00.000';

--LOGIC G with different job

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002567-04'; 
DECLARE @FromDate DATE = '2022-11-11 00:00:00.000';
DECLARE @ToDate DATE = '2022-11-29 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2022-11-30 00:00:00.000';
DECLARE @ToDate DATE = '2023-04-05 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002567-04'; 
DECLARE @FromDate DATE = '2023-04-06 00:00:00.000';
DECLARE @ToDate DATE = '2023-12-10 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2023-12-11 00:00:00.000';
DECLARE @ToDate DATE = '2025-02-05 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002200-04'; 
DECLARE @FromDate DATE = '2024-01-11 00:00:00.000';
DECLARE @ToDate DATE = '2024-10-05 00:00:00.000';

--LOGIC G with different job OUTPUT

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002567-04'; 
DECLARE @FromDate DATE = '2022-11-11 00:00:00.000';
DECLARE @ToDate DATE = '2022-11-29 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2022-11-30 00:00:00.000';
DECLARE @ToDate DATE = '2023-04-05 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002567-04'; 
DECLARE @FromDate DATE = '2023-04-06 00:00:00.000';
DECLARE @ToDate DATE = '2023-12-10 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2023-12-11 00:00:00.000';
DECLARE @ToDate DATE = '2024-01-10 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002200-04'; 
DECLARE @FromDate DATE = '2024-01-11 00:00:00.000';
DECLARE @ToDate DATE = '2024-10-05 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2024-10-06 00:00:00.000';
DECLARE @ToDate DATE = '2025-02-05 00:00:00.000';

--LOGIC C1 with same job

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002567-04'; 
DECLARE @FromDate DATE = '2022-11-11 00:00:00.000';
DECLARE @ToDate DATE = '2022-11-29 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2022-11-30 00:00:00.000';
DECLARE @ToDate DATE = '2023-04-05 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002567-04'; 
DECLARE @FromDate DATE = '2023-04-06 00:00:00.000';
DECLARE @ToDate DATE = '2023-12-10 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2023-12-11 00:00:00.000';
DECLARE @ToDate DATE = '2024-01-10 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002200-04'; 
DECLARE @FromDate DATE = '2024-01-11 00:00:00.000';
DECLARE @ToDate DATE = '2024-10-05 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2024-10-06 00:00:00.000';
DECLARE @ToDate DATE = '2025-02-05 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002200-04'; 
DECLARE @FromDate DATE = '2024-01-01 00:00:00.000';
DECLARE @ToDate DATE = '2024-10-05 00:00:00.000';


--LOGIC C1 with same job Output

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002567-04'; 
DECLARE @FromDate DATE = '2022-11-11 00:00:00.000';
DECLARE @ToDate DATE = '2022-11-29 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2022-11-30 00:00:00.000';
DECLARE @ToDate DATE = '2023-04-05 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002567-04'; 
DECLARE @FromDate DATE = '2023-04-06 00:00:00.000';
DECLARE @ToDate DATE = '2023-12-10 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2023-12-11 00:00:00.000';
DECLARE @ToDate DATE = '2023-12-31 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002200-04'; 
DECLARE @FromDate DATE = '2024-01-11 00:00:00.000';
DECLARE @ToDate DATE = '2024-10-05 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2024-10-06 00:00:00.000';
DECLARE @ToDate DATE = '2025-02-05 00:00:00.000';

--LOGIC C1 with different job

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002567-04'; 
DECLARE @FromDate DATE = '2022-11-11 00:00:00.000';
DECLARE @ToDate DATE = '2022-11-29 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2022-11-30 00:00:00.000';
DECLARE @ToDate DATE = '2023-04-05 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002567-04'; 
DECLARE @FromDate DATE = '2023-04-06 00:00:00.000';
DECLARE @ToDate DATE = '2023-12-10 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2023-12-11 00:00:00.000';
DECLARE @ToDate DATE = '2023-12-31 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002200-04'; 
DECLARE @FromDate DATE = '2024-01-11 00:00:00.000';
DECLARE @ToDate DATE = '2024-10-05 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2024-10-06 00:00:00.000';
DECLARE @ToDate DATE = '2025-02-05 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002200-04'; 
DECLARE @FromDate DATE = '2023-03-06 00:00:00.000';
DECLARE @ToDate DATE = '2023-12-10 00:00:00.000';

--LOGIC C1 with different job output

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002567-04'; 
DECLARE @FromDate DATE = '2022-11-11 00:00:00.000';
DECLARE @ToDate DATE = '2022-11-29 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2022-11-30 00:00:00.000';
DECLARE @ToDate DATE = '2023-03-05 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002200-04'; 
DECLARE @FromDate DATE = '2023-03-06 00:00:00.000';
DECLARE @ToDate DATE = '2023-12-10 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2023-12-11 00:00:00.000';
DECLARE @ToDate DATE = '2023-12-31 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002200-04'; 
DECLARE @FromDate DATE = '2024-01-01 00:00:00.000';
DECLARE @ToDate DATE = '2024-10-05 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2024-10-06 00:00:00.000';
DECLARE @ToDate DATE = '2025-02-05 00:00:00.000';

--LOGIC B1 with same job

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002567-04'; 
DECLARE @FromDate DATE = '2022-11-11 00:00:00.000';
DECLARE @ToDate DATE = '2022-11-29 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2022-11-30 00:00:00.000';
DECLARE @ToDate DATE = '2023-03-05 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002200-04'; 
DECLARE @FromDate DATE = '2023-03-06 00:00:00.000';
DECLARE @ToDate DATE = '2023-12-10 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2023-12-11 00:00:00.000';
DECLARE @ToDate DATE = '2023-12-31 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002200-04'; 
DECLARE @FromDate DATE = '2024-01-01 00:00:00.000';
DECLARE @ToDate DATE = '2024-10-05 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2024-10-06 00:00:00.000';
DECLARE @ToDate DATE = '2025-02-05 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2023-12-11 00:00:00.000';
DECLARE @ToDate DATE = '2024-03-05 00:00:00.000';


--LOGIC B1 with same job OUTPUT

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002567-04'; 
DECLARE @FromDate DATE = '2022-11-11 00:00:00.000';
DECLARE @ToDate DATE = '2022-11-29 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2022-11-30 00:00:00.000';
DECLARE @ToDate DATE = '2023-03-05 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002200-04'; 
DECLARE @FromDate DATE = '2023-03-06 00:00:00.000';
DECLARE @ToDate DATE = '2023-12-10 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2023-12-11 00:00:00.000';
DECLARE @ToDate DATE = '2024-03-05 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002200-04'; 
DECLARE @FromDate DATE = '2024-03-06 00:00:00.000';
DECLARE @ToDate DATE = '2024-10-05 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2024-10-06 00:00:00.000';
DECLARE @ToDate DATE = '2025-02-05 00:00:00.000';


--LOGIC B1 with different job

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002567-04'; 
DECLARE @FromDate DATE = '2022-11-11 00:00:00.000';
DECLARE @ToDate DATE = '2022-11-29 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2022-11-30 00:00:00.000';
DECLARE @ToDate DATE = '2023-03-05 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002200-04'; 
DECLARE @FromDate DATE = '2023-03-06 00:00:00.000';
DECLARE @ToDate DATE = '2023-12-10 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2023-12-11 00:00:00.000';
DECLARE @ToDate DATE = '2024-03-05 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002200-04'; 
DECLARE @FromDate DATE = '2024-03-06 00:00:00.000';
DECLARE @ToDate DATE = '2024-10-05 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2024-10-06 00:00:00.000';
DECLARE @ToDate DATE = '2025-02-05 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002567-04'; 
DECLARE @FromDate DATE = '2023-12-11 00:00:00.000';
DECLARE @ToDate DATE = '2024-05-05 00:00:00.000';


--LOGIC B1 with different job OUTPUT

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002567-04'; 
DECLARE @FromDate DATE = '2022-11-11 00:00:00.000';
DECLARE @ToDate DATE = '2022-11-29 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2022-11-30 00:00:00.000';
DECLARE @ToDate DATE = '2023-03-05 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002200-04'; 
DECLARE @FromDate DATE = '2023-03-06 00:00:00.000';
DECLARE @ToDate DATE = '2023-12-10 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002567-04'; 
DECLARE @FromDate DATE = '2023-12-11 00:00:00.000';
DECLARE @ToDate DATE = '2024-05-05 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-002200-04'; 
DECLARE @FromDate DATE = '2024-05-06 00:00:00.000';
DECLARE @ToDate DATE = '2024-10-05 00:00:00.000';

DECLARE @UserID NVARCHAR(30) = '25002';
DECLARE @JobCode NVARCHAR(30) = 'SRU-043238'; 
DECLARE @FromDate DATE = '2024-10-06 00:00:00.000';
DECLARE @ToDate DATE = '2025-02-05 00:00:00.000';

























